(function(n){if(!n)throw"cron-selector : JQuery is needed";var t=["second","minute","hour","day","month","week","year"],s=["秒","分","时","日/月","月","日/周","年"],l=["0-59","0-59","0-23","1-31","1-12","1-7","1970-2099"],h=["2","3","4","5","6","7","1"],a=["/","-","*",",","?","L","C","#"],r="typeSelector",u="valueCheckBox",f="start",e="end",o="distance",v={containerClass:"",locatedWeek:!1},i={period:"period",assign:"assign",empty:"empty"},y=function(n){return s[t.indexOf(n)]},c=function(n){var i=l[t.indexOf(n)];return i?i.split("-"):i};n.cronSelector=function(l){var l=this.options=n.extend(v,l),w=this.container=n('<div class="pb-tag-box '+this.options.containerClass+'"><\/div>').appendTo(n(l.container)),d=function(){for(var i=['<div class="pb-tag">'],r=['<div class="pb-tag-body">'],n=0;n<t.length;n++)i.push('<div class="pb-tag-item" tabCode="'+t[n]+'">'+s[n]+"<\/div>"),r.push('<div class="pb-tag-body-item" tabItemCode="'+t[n]+'" style="display: none"><\/div>');return i.push("<\/div>"),r.push("<\/div>"),w.append(i.join("")),w.append(r.join(""))},p=function(t){return n("div[tabItemCode="+t+"]",w)},g=function(t){var a=p(t),u=y(t),l=c(t)||["",""],s=l[0],h=l[1];n(a).append('<div class="pb-form-item">\n                        <input class="'+r+' pb-form-check" type="checkbox" name="'+i.period+'"> 从<input class="pb-form-input '+f+'" type="number" min="'+s+'" max="'+h+'">'+u+'开始,\n                        到<input class="pb-form-input '+e+'" type="number" min="'+s+'" max="'+h+'">'+u+'结束,\n                        每<input class="pb-form-input '+o+'" type="number" min="0" max="'+(h-s)+'">'+u+"执行一次\n                <\/div>")},nt=function(t){var s=p(t),o=c(t),e,f;if(o){for(e=['<div class="assignInput">\n                    <span class="pb-form-item">\n                        <input class="'+r+' pb-form-check" type="checkbox" name="'+i.assign+'">指定时间                    <\/span>'],f=o[0];f<=o[1];f++)e.push('<span class="pb-form-item">\n                        <input class="pb-form-check '+u+'" type="checkbox" value="'+f+'">'+f+"                    <\/span>");e.push("<\/div>");n(s).append(e.join(""))}},tt=function(){for(var n=0;n<t.length;n++)g(t[n]),nt(t[n])},it=function(){var n=d(w);tt(n)},rt=function(){n("[tabcode]").click(function(){var t=n(this).attr("tabcode");n(this).addClass("active").siblings().removeClass("active");n("div[tabitemcode="+t+"]").show().siblings().hide()})},b=function(n){var t=p(n);t.find("input").prop("checked",!1)},ut=function(){n("div[tabItemCode]",w).each(function(){var t=n(this),i=n(this).attr("tabItemCode");n("input."+r,t).on("change",function(){n(this).prop("checked")&&(n("input."+r,t).not(n(this)).prop("checked",!1),i=="week"&&b("day"),i=="day"&&b("week"))})})},ft=function(n){var u=p(n).find("input."+r+":checked"),t=u.length>0?u.attr("name"):i.empty;return t==i.period?et(n):t==i.assign?ot(n):t==i.empty?st(n):void 0},et=function(t){var i=p(t),u=n("input."+f,i).val(),s=n("input."+e,i).val(),h=n("input."+o,i).val(),r=u||"";return s&&u&&(r+="-"+s),h&&(r+="/"+h),r||"*"},ot=function(t){var r=p(t),i=[];return n("input."+u+":checked",r).each(function(){i.push(n(this).attr("value"))}),i.join(",")||"0"},k=function(n,t){var i,r;if(!n)return n;for(i=n.split(""),r=0;r<i.length;r++)a.indexOf(i[r])==-1&&(i[r]=t?h.indexOf(i[r])+1:h[parseInt(i[r])-1]);return i.join("")},st=function(n){return n=="week"||n=="day"?"?":"*"},ht=function(n){return/^[0-9]+.?[0-9]*$/.test(n)},ct=function(n){return!n||n=="*"||n=="?"?i.empty:n.indexOf("/")!=-1||n.indexOf("-")!=-1?i.period:n.indexOf(",")!=-1||ht(n)?i.assign:void 0},lt=function(t,r){var s=p(r),h,u,c;n('input[name="'+i.period+'"]',s).prop("checked",!0);h=t.split("/");u=h[0].split("-");u!="*"&&(n("input."+f,s).val(u[0]),u.length>1&&n("input."+e,s).val(u[1]));h.length>1&&(c=h[1],n("input."+o,s).val(c))},at=function(t,r){var o=p(r),e,f;for(n('input[name="'+i.assign+'"]',o).prop("checked",!0),e=t.split(","),f=0;f<e.length;f++)n("input[value="+e[f]+"]."+u,o).prop("checked",!0)},vt=function(){rt();ut()},yt=function(){it();vt()};return yt(),this.val=function(){for(var r,n=[],i=0;i<t.length;i++)n.push(ft(t[i]));return r=n[t.indexOf("week")],r=="?"&&n[t.indexOf("day")]=="?"&&(n[t.indexOf("day")]="*"),this.options.locatedWeek&&(n[t.indexOf("week")]=k(r)),n.join(" ")},this.parseVal=function(n){var u=n.split(" "),r;for(u[t.indexOf("week")]=k(u[t.indexOf("week")],!0),r=0;r<u.length;r++){var f=u[r],e=t[r],o=ct(f);o==i.assign?at(f,e):o==i.period&&lt(f,e)}},this}})($);