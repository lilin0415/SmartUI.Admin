(function(n){n.fn.jsCronUI=function(t){var i,r;if(typeof t=="string")r=Array.prototype.slice.call(arguments,1),this.each(function(){var u=n.data(this,"jsCronUI");if(!u)throw new CronError(11,t,[t]);if(!n.isFunction(u[t])||t.charAt(0)==="_")throw new CronError(10,t,[t]);i=u[t].apply(u,r)});else return this.each(function(){var i=n(this),r=new jsCronUI(t,i);n(this).data("jsCronUI",r)});return typeof i!="undefined"?i:this}}).call(this,jQuery),function(){function n(n,i,r){if(this.number=n,this.message=t.filter(function(t){return t.id===n})[0].message,r)for(var u=r.length-1;u>=0;u--)this.message=this.message.replace(new RegExp("%"+(u+1),"g"),r[u]);this.data=i;this.stack=(new Error).stack}var t=[{id:10,message:"No such method %1."},{id:11,message:"Cannot call method %1 on jsCronUI prior to initialization."},{id:12,message:"Could not load schedule with expression: %1."},{id:13,message:"A schedule type is required."},{id:14,message:"No template found or provided. Please provide a template or include the default template file."},{id:20,message:"A time is required."},{id:30,message:"A daily or weekday repetition pattern selection is required."},{id:40,message:"One or more days of the week are required."},{id:50,message:"A date or day of week selection is required."},{id:51,message:"Must provide one or more days."},{id:52,message:"Must select a day of the week."},{id:53,message:"Must select an occurrence."},{id:54,message:"Invalid days: %1."},{id:60,message:"Could not understand yearly schedule options: %1."},{id:61,message:"A month and date or day of week selection is required."},{id:62,message:"Must select one or more months."},{id:63,message:"Must provide one or more days."},{id:64,message:"Must choose a day of the week."},{id:65,message:"Must choose an occurrence."},{id:66,message:"Invalid days: %1."},{id:70,message:"Not implemented: %1.toEnglishString."},{id:73,message:"Not implemented: Monthly.%1.toEnglishString."},{id:74,message:"Not implemented: Yearly.%1.toEnglishString."},{id:80,message:"Unknown error occurred inside jsCronUI library: %1."}];n.prototype=Object.create(Error.prototype);n.prototype.constructor=n;this.CronError=n}.call(this,jQuery),function(n){function t(t,i){function c(){u.$el.find("input:radio,input:checkbox").prop("checked",!1).change();u.$el.find("input:text").val("").change();s();u.$el.find(".c-schedule-options").hide();u.$el.find('[name="time"]').attr("data-time","");u.$el.find("select[multiple]").multipleSelect("setSelects",[]);o()}function l(){if(t&&(!t.container||!t.container instanceof jQuery))if(n.fn.jsCronUI.template)u.$el.append(n.fn.jsCronUI.template());else throw new CronError(14);k();u.$bindTo&&u.$bindTo instanceof jQuery&&u.initialValue&&u.setCron(u.initialValue);u.$el.find("div input,select").on("change",function(){w();b()})}function a(){var t;if(!r.time)throw new CronError(20);switch(r.pattern){case"daily":switch(r.selected){case"daily":case"weekday":break;default:throw new CronError(30,r.selected);}break;case"weekly":if(r.days.length===0||n.inArray("",r.days)>=0)throw new CronError(40,r.pattern);break;case"monthly":switch(r.selected){case"last":break;case"date":if(r.days.length===0||n.inArray("",r.days)>=0)throw new CronError(51);if(t=[],n.each(r.days,function(n,i){i>31&&t.push(i)}),t.length>0)throw new CronError(54,null,[t.join(", ")]);break;case"week":if(!r.occurrence)throw new CronError(53);if(!r.dayOfWeek)throw new CronError(52);break;default:throw new CronError(50,r.selected);}break;case"yearly":switch(r.selected){case"specificDay":if(r.months.length===0||n.inArray("",r.months)>=0)throw new CronError(62);if(r.days.length===0||n.inArray("",r.days)>=0)throw new CronError(63);if(t=[],n.each(r.days,function(n,i){i>31&&t.push(i)}),t.length>0)throw new CronError(66,null,[t.join(", ")]);break;case"weekOccurrence":if(!r.occurrence)throw new CronError(65);if(!r.dayOfWeek)throw new CronError(64);if(r.months.length===0||n.inArray("",r.months)>=0)throw new CronError(62);break;default:throw new CronError(61,r.selected);}break;default:throw new CronError(13,r.pattern);}return!0}function v(n){var o,i,u,f;if(!n)return undefined;if(o=8,i=n.trim().match(/^(\d{1,2})(?::)*([0-5][0-9])?\s*((P|A)(?:M)?)?$/i),i===null)return null;var t=Number(i[1]),e=i[2]?Number(i[2]):0,r=i[4];return t>12&&r||t>23?null:(!r&&t<12&&t>0&&t<o&&i[1].length===1&&(t=t+12),t<12&&t>0&&r&&r.toUpperCase()==="P"&&(t=t+12),t===12&&r&&r.toUpperCase()==="A"&&(t=0),u=t.toString(),f=e.toString(),t<10&&(u="0"+u),e<10&&e!=="00"&&(f="0"+f),u+":"+f+":00")}function y(n){var i;if(!n)return undefined;if(i=n.trim().match(/^(\d{2})(?::)(\d{2})(?::)?(\d{2})?$/i),i===null)return null;var t=Number(i[1]),r=Number(i[2]),u="am";return t>=12&&(u="pm",t=t===12?12:t-12),t===0&&(t=12),t+":"+(r<10?"0"+r:r)+" "+u.toUpperCase()}function p(n){var i=n.val(),t="",r;t=i?v(i):n.attr("data-time");r=y(t);n.attr("data-time",t).val(r).change()}function w(){n.each(['[name="date"]','[name="dayOfMonth"]'],function(n,t){var e=/[^\d\.\-]/g,i=u.$el.find(t),r=i.val().split(/[\s,]+/),f=r.map(function(n){var t,i,r;return n?(t=n.replace(e,""),n.indexOf("-")>=0)?(i=t.substring(0,t.indexOf("-")),r=t.substring(t.indexOf("-")+1,t.length),Math.floor(i)+"-"+Math.floor(r)):Math.floor(t).toString():n}).filter(function(n,t,i){return i.length==0||n&&t===i.indexOf(n)});i.val()&&r.toString()!==f.toString()&&i.val(f.join()).change()})}function o(){u.$el.find('.c-schedule-type input:radio[value="'+r.pattern+'"]').prop("checked",!0).change();u.$el.find('[name="time"]').val(r.time);u.$el.find('[name="time"]').trigger("blur");switch(r.pattern){case"daily":u.$el.find('[name="dailyPattern"][value="'+r.selected+'"]').prop("checked",!0).change();break;case"weekly":n.each(r.days,function(){u.$el.find('[name="weeklyDays"] input:checkbox[value="'+this+'"]').prop("checked",!0).change()});break;case"monthly":u.$el.find('.js-schedule-monthly [name="monthlyPattern"][value="'+r.selected+'"]').prop("checked",!0).change();u.$el.find('.js-schedule-monthly [name="date"]').val(r.days.join()).change();u.$el.find('.js-schedule-monthly [name="weekOccurrence"]').val(r.occurrence).change();u.$el.find('.js-schedule-monthly [name="dayOfWeek"]').val(r.dayOfWeek).change();break;case"yearly":u.$el.find('.js-schedule-yearly [name="yearPattern"][value="'+r.selected+'"]').prop("checked",!0).change();u.$el.find('.js-schedule-yearly [name="dayOfMonth"]').val(r.days.join()).change();u.$el.find('.js-schedule-yearly [name="weekOccurrence"]').val(r.occurrence).change();u.$el.find('.js-schedule-yearly [name="dayOfWeek"]').val(r.dayOfWeek).change();r.selected==="specificDay"&&u.$el.find('.js-schedule-yearly [name="monthSpecificDay"]').multipleSelect("setSelects",r.months);r.selected==="weekOccurrence"&&u.$el.find('.js-schedule-yearly [name="monthOccurrence"]').multipleSelect("setSelects",r.months)}}function e(n){return n.length===1?n[0]:n.length===2?n.join(" and "):n.length>2?n.slice(0,-1).join(", ")+" and "+n.slice(-1):""}function b(){if(!f){r.pattern=u.$el.find('[name="ScheduleType"]:checked').val();r.time=u.$el.find('[name="time"]').attr("data-time");switch(r.pattern){case"daily":r.selected=u.$el.find('[name="dailyPattern"]:checked').val();break;case"weekly":r.days=u.$el.find('div[name="weeklyDays"] input:checkbox:checked').map(function(){return this.value}).get();break;case"monthly":r.selected=u.$el.find('.js-schedule-monthly [name="monthlyPattern"]:checked').val();r.occurrence=u.$el.find('.js-schedule-monthly [name="weekOccurrence"]').val();r.dayOfWeek=u.$el.find('.js-schedule-monthly [name="dayOfWeek"]').val();r.days=u.$el.find('.js-schedule-monthly [name="date"]').val().split(/[\s,]+/).sort(function(n,t){return n-t});break;case"yearly":r.selected=u.$el.find('.js-schedule-yearly [name="yearPattern"]:checked').val();r.months=u.$el.find(r.selected==="specificDay"?'.js-schedule-yearly [name="monthSpecificDay"]':'.js-schedule-yearly [name="monthOccurrence"]').multipleSelect("getSelects");r.days=u.$el.find('.js-schedule-yearly [name="dayOfMonth"]').val().split(/[\s,]+/).sort(function(n,t){return n-t});r.occurrence=u.$el.find('.js-schedule-yearly [name="weekOccurrence"]').val();r.dayOfWeek=u.$el.find('.js-schedule-yearly [name="dayOfWeek"]').val()}u.$bindTo&&u.$bindTo.val()!==u.getCron()&&u.$bindTo.val(u.getCron()).change()}}function s(){u.$el.find(".js-schedule-daily").hide();u.$el.find(".js-schedule-weekly").hide();u.$el.find(".js-schedule-monthly").hide();u.$el.find(".js-schedule-yearly").hide()}function k(){u.$el.find('select[name^="month"]').multipleSelect({width:230,multiple:!0,multipleWidth:100,placeholder:"Select months",selectAll:!1,minimumCountSelected:4,ellipsis:!0,allSelected:"Every month"});u.$el.find('[name="ScheduleType"]').on("change",function(){u.$el.find(".c-schedule-options").show();var t=".js-schedule-"+n(this).val();s();u.$el.find(t).show()});u.$el.find('input[name="time"]').on("blur",function(){p(u.$el.find('input[name="time"]'))});u.$el.find(".js-schedule-monthly").find('select[name="dayOfWeek"],select[name="weekOccurrence"]').on("change",function(){f||r.selected!=="week"&&u.$el.find('[name="monthlyPattern"][value="week"]').prop("checked",!0).change()});u.$el.find('.js-schedule-monthly input[name="date"]').on("keypress",function(){f||r.selected!=="date"&&u.$el.find('[name="monthlyPattern"][value="date"]').prop("checked",!0).change()});u.$el.find(".js-schedule-yearly").find('select[name="monthOccurrence"],select[name="dayOfWeek"],select[name="weekOccurrence"]').on("change",function(){f||r.selected!=="weekOccurrence"&&u.$el.find('[name="yearPattern"][value="weekOccurrence"]').prop("checked",!0).change()});u.$el.find(".js-schedule-yearly").find('select[name="monthSpecificDay"]').on("change",function(){f||r.selected!=="specificDay"&&u.$el.find('[name="yearPattern"][value="specificDay"]').prop("checked",!0).change()});u.$el.find('.js-schedule-yearly input[name="dayOfMonth"]').on("keypress",function(){f||r.selected!=="specificDay"&&u.$el.find('[name="yearPattern"][value="specificDay"]').prop("checked",!0).change()})}var u=this,f,r;u.$el=n(i);t&&(u.$bindTo=t.bindTo||null,u.initialValue=t.initialValue);f=!1;r={time:"",pattern:"",selected:"",days:[],occurrence:"",dayOfWeek:"",months:[]};this.reset=function(){r={time:"",pattern:"",selected:"",days:[],occurrence:"",dayOfWeek:"",months:[]};f=!0;c();f=!1};this.setCron=function(n){function s(n,t){return n=n.toString(),n.length<t?s("0"+n,t):n}var u,e,i,t,h,c,l;if(n){if(t=n.split(" "),t.length===6&&t.push("*"),t.length!==7)throw new CronError(12,n,[n]);if(this.reset(),r.time=s(t[2],2)+":"+s(t[1],2),t[4]!=="*")if(r.pattern="yearly",r.months=t[4].split(","),t[3]!=="?")r.selected="specificDay",r.days=t[3].split(",");else if(t[5].indexOf("#")>0)r.selected="weekOccurrence",h=t[5].split("#"),r.dayOfWeek=h[0],r.occurrence="#"+h[1];else if(t[5].indexOf("L")>0)r.selected="weekOccurrence",r.occurrence="L",r.dayOfWeek=t[5].split("L")[0];else throw new CronError(60,n,[n]);else if(t[3]==="*"||t[5]==="*")r.pattern="daily",r.selected="daily";else if(t[5]==="2-6"||t[5]==="2,3,4,5,6")r.pattern="daily",r.selected="weekday";else if(t[5].indexOf("#")===-1&&t[5].indexOf("L")===-1&&t[5]!=="?")if(r.pattern="weekly",t[5].indexOf("-")>0){for(u=t[5].split("-"),e=[],i=parseInt(u[0]);i<=parseInt(u[1]);i++)e.push(i);r.days=e}else r.days=t[5].split(",");else if(r.pattern="monthly",t[3]==="L")r.selected="last";else if(t[5].indexOf("#")>0)c=t[5].split("#"),r.selected="week",r.dayOfWeek=c[0],r.occurrence="#"+c[1];else if(t[5].indexOf("L")>0)l=t[5].split("L")[0],r.selected="week",r.dayOfWeek=l,r.occurrence="L";else if(r.selected="date",t[3].indexOf("-")>0){for(u=t[3].split("-"),e=[],i=parseInt(u[0]);i<=parseInt(u[1]);i++)e.push(i);r.days=e}else r.days=t[3].split(",");f=!0;o();f=!1}};this.getCron=function(n){var e="*",o="*",t="*",s="*",i="?",f,u;switch(r.pattern){case"daily":switch(r.selected){case"daily":break;case"weekday":i="2-6";t="?";break;default:if(n)throw new CronError(30,r.selected);}break;case"weekly":if(i=r.days.join(","),n&&!i)throw new CronError(40,r.pattern);t="?";break;case"monthly":switch(r.selected){case"date":t=r.days.join(",");break;case"last":t="L";break;case"week":t="?";i=r.dayOfWeek+r.occurrence;break;default:if(n)throw new CronError(50,r.selected);}break;case"yearly":s=r.months.join(",");switch(r.selected){case"specificDay":t=r.days.join(",");break;case"weekOccurrence":t="?";i=r.dayOfWeek+r.occurrence;break;default:if(n)throw new CronError(61,r.selected);}break;default:if(n)throw new CronError(13,r.pattern);}if(r.time&&r.time!=="")f=r.time.split(":"),o=parseInt(f[0])+"",e=parseInt(f[1])+"";else if(n)throw new CronError(20);return u=["0",e,o,t,s,i,"*"],u=u.map(function(t){return t===""&&!n?"*":(n&&a(),t.toString())}),u.join(" ")};this.toEnglishString=function(){var t="",c=function(n){var i=n.trim().match(/^(\d{2})(?::)(\d{2})(?::)?(\d{2})?$/i);if(i===null)return null;var t=Number(i[1]),r=Number(i[2]),u="am";return t>=12&&(u="pm",t=t===12?12:t-12),t===0&&(t=12),t+":"+(r<10?"0"+r:r)+" "+u.toUpperCase()},i=c(r.time),u=function(t,i){var r;return r=n.isArray(i)?n(i).map(function(n,i){return t[parseInt(i)-1]}):t[parseInt(i)-1],n.makeArray(r)},f=function(n){return u(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n)},s=function(n){return u(["January","February","March","April","May","June","July","August","September","October","November","December"],n)},h=function(n){return u(["first","second","third","fourth","fifth"],n)},o=function(t){var r,i;if(t.indexOf("-")>0)return r=n.map(t.split("-"),o),r.join("-");i="th";switch(t+""){case"1":case"21":case"31":i="st";break;case"2":case"22":i="nd";break;case"3":case"23":i="rd"}return t+i},l=function(n,t){return n-t};switch(r.pattern){case"daily":t="Every "+(r.selected==="weekday"?"week":"")+"day at "+i;break;case"weekly":t="Every week on "+e(f(r.days))+" at "+i;break;case"monthly":t="Every month on the ";switch(r.selected){case"date":t+=e(n.map(r.days,o))+" at "+i;break;case"week":r.occurrence!==""&&(t+=r.occurrence==="L"?"last":h(r.occurrence.split("#")),t+=" "+f(r.dayOfWeek)+" at "+i);break;case"last":t+="last day of the month at "+i;break;default:throw new CronError(73,r.selected,[r.selected]);}break;case"yearly":t="Every year on ";switch(r.selected){case"specificDay":t+=e(s(r.months))+" "+e(n.map(r.days,o))+" at "+i;break;case"weekOccurrence":t+="the ";t+=r.occurrence==="L"?"last ":h(r.occurrence.split("#"))+" ";t+=f(r.dayOfWeek)+" of "+e(s(r.months))+" at "+i;break;default:throw new CronError(74,r.selected,[r.selected]);}break;default:throw new CronError(70,r.pattern,[r.pattern]);}return t};try{l()}catch(h){throw new CronError(80,h,[h.message]);}}this.jsCronUI=t}.call(this,jQuery);